---

- name: Deploy secrets for MCSP ArgoCD deployments
  hosts: mcsp_argocd
  gather_facts: false
  tags: mcsp_argocd_secrets
  roles:
  - role: mcsp_deploy_argocd_secrets
    api_key: "{{ hostvars['cluster-facts']['api_key'] | default(omit) }}"
    kubeconfig_path: "{{ hostvars['cluster-facts']['kubeconfig_path'] }}"
    secrets_dir: "{{ hostvars['playbook-secrets']['secrets_dir'] }}"
    target_namespace: "{{ mcsp_argocd_namespace }}"
