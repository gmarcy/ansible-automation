---

- name: Install IBM Zen Operator and Operands into cluster
  hosts: was_automation
  gather_facts: false
  tags: was_automation
  roles:
  - role: install_zen_operator
    api_key: "{{ hostvars['cluster-facts']['api_key'] }}"
    kubeconfig_path: "{{ hostvars['cluster-facts']['kubeconfig_path'] }}"
    target_namespace: wasautomation
    registry_namespace: ibm-common-services
  - role: install_zen_instance
    api_key: "{{ hostvars['cluster-facts']['api_key'] }}"
    kubeconfig_path: "{{ hostvars['cluster-facts']['kubeconfig_path'] }}"
    target_namespace: wasautomation
    registry_namespace: ibm-common-services
    zen_storage_class: "{{ hostvars['cluster-storage']['default_storage_class'] }}"
