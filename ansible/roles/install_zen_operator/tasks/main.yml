---

- name: Create the Zen OperandRequest
  kubernetes.core.k8s:
    api_key: "{{ api_key | default(omit) }}"
    api_version: operator.ibm.com/v1alpha1
    kind: OperandRequest
    kubeconfig: "{{ kubeconfig_path }}"
    name: operand-request-zen
    namespace: "{{ target_namespace }}"
    definition:
      metadata:
        labels: "{{ common_service_opreq_labels }}"
      spec:
        requests:
        - operands:
          - name: ibm-zen-operator
          registry: "{{ common_service_operand_name }}"
          registryNamespace: "{{ registry_namespace }}"
    wait: true
    wait_condition:
      type: Ready
    wait_sleep: 20
    wait_timeout: 300
  register: _result
