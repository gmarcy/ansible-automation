---

- name: Create a secret containing all of the secrets needed by ArgoCD in Fyre
  kubernetes.core.k8s:
    api_key: "{{ api_key | default(omit) }}"
    kubeconfig: "{{ kubeconfig_path }}"
    definition: "{{ lookup('template', item) | from_yaml }}"
  loop:
  - 'argocd-deployment.yaml.j2'
  - 'argocd-fyre-credentials.yaml.j2'
