---

- name: Create NamespaceScope operands
  kubernetes.core.k8s:
    api_key: "{{ api_key | default(omit) }}"
    api_version: operator.ibm.com/v1
    kind: NamespaceScope
    kubeconfig: "{{ kubeconfig_path }}"
    name: "{{ common_service_operand_name }}"
    namespace: "{{ target_namespace }}"
    definition:
      spec:
        csvInjector:
          enable: true
        namespaceMembers:
        - "{{ common_service_namespace }}"
        - openshift-redhat-marketplace
  register: _result

- name: Create NamespaceScope operands
  kubernetes.core.k8s:
    api_key: "{{ api_key | default(omit) }}"
    api_version: operator.ibm.com/v1
    kind: NamespaceScope
    kubeconfig: "{{ kubeconfig_path }}"
    name: nss-managedby-odlm
    namespace: "{{ target_namespace }}"
    definition:
      spec:
        csvInjector:
          enable: true
        namespaceMembers:
        - "{{ common_service_operator_namespace }}"
        - "{{ common_service_namespace }}"
  register: _result

- name: Create NamespaceScope operands
  kubernetes.core.k8s:
    api_key: "{{ api_key | default(omit) }}"
    api_version: operator.ibm.com/v1
    kind: NamespaceScope
    kubeconfig: "{{ kubeconfig_path }}"
    name: nss-odlm-scope
    namespace: "{{ target_namespace }}"
    definition:
      spec:
        configmapName: odlm-scope
        csvInjector:
          enable: false
        namespaceMembers:
        - openshift-redhat-marketplace
        - "{{ common_service_namespace }}"
        restartLabels:
          intent: projected-odlm
  register: _result

- name: Create NamespaceScope operands
  kubernetes.core.k8s:
    api_key: "{{ api_key | default(omit) }}"
    api_version: operator.ibm.com/v1
    kind: NamespaceScope
    kubeconfig: "{{ kubeconfig_path }}"
    name: odlm-scope-managedby-odlm
    namespace: "{{ target_namespace }}"
    definition:
      spec:
        configmapName: odlm-scope
        csvInjector:
          enable: false
        namespaceMembers:
        - "{{ common_service_namespace }}"
        - "{{ common_service_operator_namespace }}"
        restartLabels:
          intent: projected-odlm
  register: _result
