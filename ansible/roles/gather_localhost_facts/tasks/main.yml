---

- name: Gather facts
  ansible.builtin.setup:
    gather_subset:
    - '!all'
    - 'network'

- name: Clear ansible_facts
  set_fact:
    ansible_facts: {}

- name: Set derived localhost facts
  set_fact:
    cpu_arch: "{{ 'amd64' if (ansible_architecture == 'x86_64') else ansible_architecture }}"
    os_family: "{{ 'mac' if (ansible_os_family == 'Darwin') else ('windows' if (ansible_os_family == 'Windows') else 'linux') }}"
    local_path: "{{ ansible_env['PATH'] }}"
    local_home: "{{ ansible_user_dir }}"
    local_user: "{{ ansible_user_id }}"
